{
  "properties": {
    "activities": [
      {
        "name": "Transform Time Dimension",
        "type": "SynapseNotebook",
        "dependsOn": [],
        "typeProperties": {
          "notebook": {
            "referenceName": "nb_bronze_to_silver_time_dim",
            "type": "NotebookReference"
          },
          "parameters": {},
          "snapshot": true,
          "conf": {
            "spark.dynamicAllocation.enabled": "true",
            "spark.dynamicAllocation.minExecutors": "1",
            "spark.dynamicAllocation.maxExecutors": "3"
          }
        }
      },
      {
        "name": "Transform Location Dimension",
        "type": "SynapseNotebook",
        "dependsOn": [],
        "typeProperties": {
          "notebook": {
            "referenceName": "nb_bronze_to_silver_location_dim",
            "type": "NotebookReference"
          },
          "parameters": {},
          "snapshot": true,
          "conf": {
            "spark.dynamicAllocation.enabled": "true",
            "spark.dynamicAllocation.minExecutors": "1",
            "spark.dynamicAllocation.maxExecutors": "3"
          }
        }
      },
      {
        "name": "Transform Reference Dimensions",
        "type": "SynapseNotebook",
        "dependsOn": [],
        "typeProperties": {
          "notebook": {
            "referenceName": "nb_bronze_to_silver_payment_vendor_dims",
            "type": "NotebookReference"
          },
          "parameters": {},
          "snapshot": true,
          "conf": {
            "spark.dynamicAllocation.enabled": "true",
            "spark.dynamicAllocation.minExecutors": "1",
            "spark.dynamicAllocation.maxExecutors": "2"
          }
        }
      },
      {
        "name": "Transform Fact Table",
        "type": "SynapseNotebook",
        "dependsOn": [
          {
            "activity": "Transform Time Dimension",
            "dependencyConditions": ["Succeeded"]
          },
          {
            "activity": "Transform Location Dimension",
            "dependencyConditions": ["Succeeded"]
          },
          {
            "activity": "Transform Reference Dimensions",
            "dependencyConditions": ["Succeeded"]
          }
        ],
        "typeProperties": {
          "notebook": {
            "referenceName": "nb_bronze_to_silver_fact_trips",
            "type": "NotebookReference"
          },
          "parameters": {},
          "snapshot": true,
          "conf": {
            "spark.dynamicAllocation.enabled": "true",
            "spark.dynamicAllocation.minExecutors": "2",
            "spark.dynamicAllocation.maxExecutors": "5"
          }
        }
      },
      {
        "name": "Data Quality Validation",
        "type": "SynapseNotebook",
        "dependsOn": [
          {
            "activity": "Transform Fact Table",
            "dependencyConditions": ["Succeeded"]
          }
        ],
        "typeProperties": {
          "notebook": {
            "referenceName": "nb_silver_data_quality_validation",
            "type": "NotebookReference"
          },
          "parameters": {},
          "snapshot": true,
          "conf": {
            "spark.dynamicAllocation.enabled": "true",
            "spark.dynamicAllocation.minExecutors": "1",
            "spark.dynamicAllocation.maxExecutors": "2"
          }
        }
      }
    ],
    "parameters": {
      "run_date": {
        "type": "string",
        "defaultValue": "@formatDateTime(utcnow(), 'yyyy-MM-dd')"
      },
      "batch_size": {
        "type": "int",
        "defaultValue": 10000
      }
    },
    "variables": {
      "pipeline_start_time": {
        "type": "String",
        "defaultValue": "@utcnow()"
      },
      "error_count": {
        "type": "Integer",
        "defaultValue": 0
      }
    },
    "annotations": [
      {
        "key": "purpose",
        "value": "Bronze to Silver transformation orchestration"
      },
      {
        "key": "schedule",
        "value": "Daily at 02:00 AM"
      },
      {
        "key": "owner",
        "value": "Data Engineering Team"
      }
    ],
    "folder": {
      "name": "Data Transformation Pipelines"
    }
  }
}